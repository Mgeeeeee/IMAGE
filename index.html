<!--
INPUT: ÊµèËßàÂô®ÁéØÂ¢É„ÄÅÁî®Êà∑ËæìÂÖ•„ÄÅAPI ÈÖçÁΩÆ/ÂìçÂ∫î„ÄÅÊú¨Âú∞ÁºìÂ≠ò
OUTPUT: UI Ê∏≤Êüì„ÄÅÂõæÁâáÁîüÊàêËØ∑Ê±Ç„ÄÅ‰∏ãËΩΩ/ÂàÜ‰∫´
POS: ÂçïÈ°µÂ∫îÁî®ÂîØ‰∏ÄËøêË°åÂÖ•Âè£
UPDATE: ‰∏ÄÊó¶ÊàëË¢´Êõ¥Êñ∞ÔºåÂä°ÂøÖÊõ¥Êñ∞ÊàëÁöÑÂºÄÂ§¥Ê≥®ÈáäÔºå‰ª•ÂèäÊâÄÂ±ûÁöÑÊñá‰ª∂Â§πÁöÑmd„ÄÇ
UPDATED: 2026-01-24
-->
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#f1f5f9">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>IMAGE</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="icon" type="image/png" sizes="180x180" href="assets/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
    <link rel="stylesheet" href="assets/styles.css">
</head>

<body>
    <canvas id="bgCanvas"></canvas>

    <div id="errorMessage" class="error-message"></div>

    <div class="preview-area">
        <div class="preview-container" id="previewContainer">
            <div class="empty-state" id="emptyState">
                <div class="empty-logo">IMAGE</div>
                <div class="empty-subtitle">ÁæéÂ•ΩÂÄºÂæóÁ≠âÂæÖ</div>
            </div>
            <div class="preload-frame" id="preloadFrame"></div>
            <canvas class="loading-canvas" id="loadingCanvas"></canvas>
            <div class="loading-caption" id="loadingCaption">ÁæéÂ•ΩÂÄºÂæóÁ≠âÂæÖ</div>
            <img id="mainPreview" src="" alt="È¢ÑËßàÂõæ">
        </div>
    </div>

    <div class="action-cluster">
        <button class="action-tool" id="downloadBtn" onclick="downloadCurrentImage()" title="‰∏ãËΩΩ">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 3v12" />
                <path d="M7 10l5 5 5-5" />
                <path d="M5 21h14" />
            </svg>
        </button>
        <div class="action-button" id="actionButton" onclick="expandActionCenter()" aria-label="ÊâìÂºÄÈù¢Êùø" role="button" tabindex="0"></div>
        <button class="action-tool" id="regenBtn" onclick="regenerateLast(event)" title="ÈáçÊñ∞ÁîüÊàê">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 12a9 9 0 0 1 15.3-6.3" />
                <path d="M21 3v6h-6" />
                <path d="M21 12a9 9 0 0 1-15.3 6.3" />
                <path d="M3 21v-6h6" />
            </svg>
        </button>
    </div>

    <div class="action-panel" id="actionPanel">
        <div class="display-area">
            <!-- ËÆæÁΩÆ Tab -->
            <div id="tab-settings" class="tab-content">
                <div class="modal-header">
                    <h2>Á≥ªÁªüËÆæÁΩÆ</h2>
                </div>
                <div class="form-group" style="display: none;">
                    <label>API Âú∞ÂùÄ</label>
                    <input type="text" id="apiUrl" value="https://api.tu-zi.com">
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>API Key</label>
                        <span id="balanceDisplay" class="balance-chip" style="display:none">‰ΩôÈ¢ù: --</span>
                    </div>
                    <input type="password" id="apiKey"
                        onchange="handleConfigChange()">
                </div>
                <div class="form-group">
                    <label>Ê®°ÂûãËÆæÁΩÆ</label>
                    <div class="model-btn-group">
                        <button class="model-quick-btn" id="btn-vip" data-role="quick-toggle"
                            onclick="window.toggleVip && toggleVip()">üëë VIP</button>
                        <button class="model-quick-btn" id="btn-banana" data-role="quick-model"
                            onclick="selectQuickModel('nano-banana', 'btn-banana')">üçå</button>
                        <button class="model-quick-btn" id="btn-banana-pro" data-role="quick-model"
                            onclick="selectQuickModel('nano-banana-2', 'btn-banana-pro')">üçå PRO</button>
                        <select id="sizeSelect" class="model-quick-btn model-quick-select"
                            onchange="handleConfigChange()">
                            <option value="">‰∏çËÆæÁΩÆ</option>
                            <option value="1:1">1:1</option>
                            <option value="2:3">2:3</option>
                            <option value="3:2">3:2</option>
                            <option value="3:4">3:4</option>
                            <option value="4:3">4:3</option>
                            <option value="4:5">4:5</option>
                            <option value="5:4">5:4</option>
                            <option value="9:16">9:16</option>
                            <option value="16:9">16:9</option>
                            <option value="21:9">21:9</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <div class="label-row">
                        <label>ÂÖ∂‰ªñÊ®°Âûã</label>
                        <button class="icon-btn" id="refreshModelsBtn" onclick="fetchAndUpdateModels()"
                            title="Âà∑Êñ∞Ê®°ÂûãÂàóË°®" aria-label="Âà∑Êñ∞Ê®°ÂûãÂàóË°®">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 12a9 9 0 0 1-15.3 6.3" />
                                <path d="M3 12a9 9 0 0 1 15.3-6.3" />
                                <path d="M21 3v6h-6" />
                                <path d="M3 21v-6h6" />
                            </svg>
                        </button>
                    </div>
                    <select id="modelSelect" class="model-select-inline" onchange="handleConfigChange()">
                        <option value="">ÁÇπÂáªÂè≥‰∏äÂà∑Êñ∞Ëé∑ÂèñÂàóË°®</option>
                    </select>
                </div>
            </div>

            <!-- È£éÊ†º Tab -->
            <div id="tab-style" class="tab-content">
                <div class="modal-header">
                    <h2>È£éÊ†ºÈ¢ÑËÆæ</h2>
                </div>
                <div class="form-group">
                    <div class="preset-container" id="presetContainer"></div>
                </div>
            </div>

            <!-- ‰∏ä‰º† Tab -->
            <div id="tab-upload" class="tab-content">
                <div class="modal-header">
                    <h2>‰ΩøÁî®ÂõæÁâá</h2>
                </div>
                <div id="uploadPreview"
                    style="width: 100%; flex: 1; min-height: 80px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 16px;">
                </div>
                <button class="modal-action-btn" onclick="document.getElementById('imageUpload').click()">
                    ‰∏ä‰º†ÂõæÂÉè
                </button>
            </div>

            <!-- ÂØπËØù/ÁîüÊàê Tab -->
            <div id="tab-chat" class="tab-content active">
                <div class="modal-header">
                    <h2>Ëá™Áî±ÂØπËØù</h2>
                </div>
                <div class="form-group">
                    <div class="textarea-wrap">
                        <textarea id="tempPromptInput" class="prompt-textarea" placeholder="ËæìÂÖ•‰Ω†ÊÉ≥ÁîüÊàêÁöÑÁîªÈù¢ÊèèËø∞..." style="height: 220px; resize: none; overflow-y: auto;"></textarea>
                        <button class="textarea-clear-btn is-hidden" type="button" onclick="clearTempPrompt()" title="Ê∏ÖÁ©∫">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round">
                                <line x1="6" y1="6" x2="18" y2="18" />
                                <line x1="6" y1="18" x2="18" y2="6" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="aux-bar">
            <button class="nav-btn" onclick="switchTab('tab-settings', event)" title="ËÆæÁΩÆ">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3" />
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
                </svg>
            </button>
            <button class="nav-btn" onclick="switchTab('tab-style', event)" title="È£éÊ†º">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                </svg>
            </button>
            <button class="nav-btn" onclick="switchTab('tab-upload', event)" title="ÂõæÂÉè">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                </svg>
            </button>
            <button class="nav-btn" onclick="switchTab('tab-chat', event)" id="chatBtn" title="ÂØπËØù">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 1 1-7.6-11.7 8.38 8.38 0 0 1 3.8.9L21 3.5z" />
                </svg>
            </button>
        <button class="gen-btn" onclick="triggerGeneration(event)" id="sendBtn" title="ÂèëÂ∞Ñ">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"
                style="width: 22px; height: 22px;" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8.5 6l1.8 4.8 4.8 1.8-4.8 1.8-1.8 4.8-1.8-4.8-4.8-1.8 4.8-1.8L8.5 6z" />
                <path d="M18.2 3.2l1 2.6 2.6 1-2.6 1-1 2.6-1-2.6-2.6-1 2.6-1 1-2.6z" />
                <path d="M17.2 14.8l.8 2.1 2.1.8-2.1.8-.8 2.1-.8-2.1-2.1-.8 2.1-.8.8-2.1z" />
            </svg>
        </button>
        </div>
    </div>

    <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">

    <script src="assets/prompt-utils.js" defer></script>
    <script src="assets/image-api.js" defer></script>
    <script src="assets/storage.js" defer></script>
    <script src="assets/ui-state.js" defer></script>
    <script src="assets/app.js" defer></script>

</body>

</html>
